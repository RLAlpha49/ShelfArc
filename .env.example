# =============================================================================
# ShelfArc — Environment Variable Reference
# =============================================================================
# Copy this file to .env.local for local development.
# Variables marked "Edge Function secret" must be set in the Supabase dashboard
# under Project Settings → Edge Functions, not in this file.
# =============================================================================

# -----------------------------------------------------------------------------
# App Configuration
# Required for local dev and production
# -----------------------------------------------------------------------------

# Base URL of the app — used for OAuth callbacks, magic links, share URLs, etc.
# Local: http://localhost:3000  |  Production: https://your-domain.com
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Public site URL — used for iCal export calendar links.
# Typically the same value as NEXT_PUBLIC_APP_URL.
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Supabase Configuration
# Get these from Supabase project settings → API
# Required for local dev and production
# -----------------------------------------------------------------------------

# Supabase project URL
NEXT_PUBLIC_SUPABASE_URL=your-supabase-url

# Publishable / anonymous key — safe to expose in the browser
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=your-supabase-publishable-key

# Alternative alias accepted as a fallback by the Supabase client
# NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key

# Service role (secret) key — NEVER expose to the browser.
# Used by server-side API routes and Supabase Edge Functions.
SUPABASE_SECRET_KEY=your-supabase-service-role-key

# Supabase storage bucket for user-uploaded media (cover images, avatars, etc.)
SUPABASE_STORAGE_BUCKET=media

# -----------------------------------------------------------------------------
# Google Books API
# Required for book search and metadata enrichment
# -----------------------------------------------------------------------------

# Primary API key
GOOGLE_BOOKS_API_KEY=your-google-books-api-key

# Optional: multiple keys for per-key quota rotation.
# Comma / space / semicolon / newline separated.
# When set, this takes precedence over GOOGLE_BOOKS_API_KEY.
GOOGLE_BOOKS_API_KEYS=your-google-books-api-key-1,your-google-books-api-key-2

# -----------------------------------------------------------------------------
# Automation & Internal API Security
# Required in production; needed locally only when testing automations
# -----------------------------------------------------------------------------

# Shared secret for the /api/automations/evaluate endpoint.
# Must match the x-evaluation-secret header sent by the check-price-alerts
# and check-release-dates Supabase Edge Functions.
# Also set this as an Edge Function secret in the Supabase dashboard.
EVALUATION_SECRET=your-evaluation-secret

# -----------------------------------------------------------------------------
# Email (Resend)
# Required in production for transactional notification emails
# Set as an Edge Function secret in the Supabase dashboard
# -----------------------------------------------------------------------------

# Resend API key — used by the send-notification-email Edge Function
RESEND_API_KEY=your-resend-api-key

# -----------------------------------------------------------------------------
# Distributed Rate Limiting
# Optional — only effective when SUPABASE_SECRET_KEY is also set
# -----------------------------------------------------------------------------

# Set to "true" to enable distributed rate limiting backed by Supabase.
# When unset or "false", the app falls back to in-process (per-instance) limiting.
DISTRIBUTED_RATE_LIMIT_ENABLED=false

# -----------------------------------------------------------------------------
# Monitoring (Sentry)
# NEXT_PUBLIC_SENTRY_DSN is required in production.
# SENTRY_AUTH_TOKEN is CI/CD only — not needed for local dev.
# -----------------------------------------------------------------------------

# Public Sentry DSN — safe to expose in the browser (used client- and server-side)
NEXT_PUBLIC_SENTRY_DSN=your-sentry-dsn

# Sentry auth token for uploading source maps during CI/CD builds.
# CI/CD only — do not set this in local .env.local unless uploading maps manually.
SENTRY_AUTH_TOKEN=your-sentry-auth-token

# -----------------------------------------------------------------------------
# Backup & Restore (Supabase Edge Functions)
# Set these as Edge Function secrets in the Supabase dashboard.
# Documented here as a reference inventory; the Next.js app does not read them.
# -----------------------------------------------------------------------------

# Shared secret required by backup-db and restore-db Edge Functions.
# The caller must supply this as the x-backup-secret request header.
BACKUP_SECRET=your-backup-secret

# Full public URL of the deployed app, used by Edge Functions to POST to
# /api/automations/evaluate. Must be reachable from Supabase's runtime.
APP_URL=https://your-domain.com

# Storage bucket for database backups
BACKUP_BUCKET=backups

# Path prefix within the backup bucket
BACKUP_PREFIX=db-backups

# Number of most-recent backup files to keep; older files are pruned after each run
BACKUP_KEEP_LAST=7

# Maximum total size (MB) of all stored backups; 0 = unlimited
BACKUP_MAX_TOTAL_MB=1024

# Rows per paginated query during backup export
BACKUP_PAGE_SIZE=1000

# Maximum rows to export per individual table; 0 = unlimited
BACKUP_MAX_ROWS_PER_TABLE=0

# Maximum total rows across all tables in a single backup; 0 = unlimited
BACKUP_MAX_TOTAL_ROWS=0

# Hard upper bound on total rows (safety valve); 0 uses the function's built-in default (250 000)
BACKUP_HARD_ROW_LIMIT=250000

# Comma-separated allowlist of table names to include in backups (empty = all tables)
BACKUP_TABLES=

# Comma-separated list of table names to exclude from backups
BACKUP_EXCLUDE_TABLES=

